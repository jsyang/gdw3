// Generated by CoffeeScript 1.4.0
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(['core/aifish'], function(AIFish) {
  var FishGame;
  return FishGame = (function(_super) {

    __extends(FishGame, _super);

    FishGame.prototype.entities = [];

    FishGame.prototype.mode = {
      current: 'move',
      move: function(dt) {}
    };

    function FishGame() {
      var chaseMouse, chasePoint1, chasePoint2, i, makeFish, p1, p2, p3;
      makeFish = function(point, chasePoint) {
        var fish;
        if (chasePoint == null) {
          chasePoint = false;
        }
        fish = new AIFish({
          x: point.x + $$.R(-120, 120),
          y: point.y + $$.R(-120, 120)
        });
        if (chasePoint === true) {
          fish.target = point;
        }
        return fish;
      };
      p1 = {
        x: $$.R(100, 300),
        y: 50
      };
      p2 = {
        x: $$.R(100, 300),
        y: 450
      };
      p3 = {
        x: $$.R(200, 400),
        y: 200
      };
      chaseMouse = (function() {
        var _i, _results;
        _results = [];
        for (i = _i = 0; _i < 3; i = ++_i) {
          _results.push(makeFish(p3));
        }
        return _results;
      })();
      chasePoint1 = (function() {
        var _i, _results;
        _results = [];
        for (i = _i = 0; _i < 3; i = ++_i) {
          _results.push(makeFish(p1, true));
        }
        return _results;
      })();
      chasePoint2 = (function() {
        var _i, _results;
        _results = [];
        for (i = _i = 0; _i < 3; i = ++_i) {
          _results.push(makeFish(p2, true));
        }
        return _results;
      })();
      this.entities = this.entities.concat(chaseMouse, chasePoint1, chasePoint2);
    }

    FishGame.prototype.update = function(dt) {
      this.mode[this.mode.current].apply(this, [dt]);
      return this.updateFish();
    };

    FishGame.prototype.updateFish = function() {
      var e, _i, _len, _ref, _results;
      _ref = this.entities;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        e = _ref[_i];
        _results.push(e.move());
      }
      return _results;
    };

    FishGame.prototype.draw = function() {
      var e, _i, _len, _ref, _results;
      atom.context.clear();
      _ref = this.entities;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        e = _ref[_i];
        _results.push(e.draw());
      }
      return _results;
    };

    FishGame.prototype.user = {
      lastMouse: {
        x: 0,
        y: 0
      }
    };

    return FishGame;

  })(atom.Game);
});
